apiVersion: apps.openliberty.io/v1beta2
# tag::kind[]
kind: OpenLibertyApplication
# end::kind[]
metadata:
  name: inventory-deployment
  labels:
    name: inventory-deployment
spec:
  # tag::applicationImage[]
  applicationImage: liberty-deepdive-inventory:1.0-SNAPSHOT
  # end::applicationImage[]
  service:
    port: 9080
  env:
    - name: CONTEXT_ROOT
      valueFrom:
        configMapKeyRef:
          name: sys-app-root
          key: contextRoot
    - name: SYSTEM_APP_USERNAME
      valueFrom:
        secretKeyRef:
          name: sys-app-credentials
          key: username
    - name: SYSTEM_APP_PASSWORD
      valueFrom:
        secretKeyRef:
          name: sys-app-credentials
          key: password
---
apiVersion: v1
kind: Service
metadata:
  name: inventory-service
spec:
  type: NodePort
  selector:
    name: inventory-deployment
  ports:
  - protocol: TCP
    port: 9080
    targetPort: 9080
    nodePort: 31000


